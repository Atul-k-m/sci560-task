<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An Open Letter to Bengaluru</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:wght@400;600&family=Crimson+Text:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a365d;
            --accent-color: #805ad5;
            --text-color: #2d3748;
            --background-color: #f7fafc;
            --card-background: #ffffff;
            --highlight-color: rgba(128, 90, 213, 0.1);
            --transition-speed: 0.3s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Crimson Text', serif;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--background-color);
            overflow-x: hidden;
            padding: 2rem 1rem;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--accent-color), var(--primary-color));
            transform-origin: 0%;
            transform: scaleX(0);
            z-index: 1000;
        }

        .letter-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 4rem;
            background: var(--card-background);
            box-shadow: 0 4px 60px rgba(0, 0, 0, 0.08);
            border-radius: 16px;
            position: relative;
            transition: transform var(--transition-speed) ease;
        }

        .letter-container:hover {
            transform: translateY(-4px);
        }

        .date {
            font-family: 'Source Sans Pro', sans-serif;
            color: var(--text-color);
            opacity: 0.7;
            margin-bottom: 2rem;
            font-size: 0.95rem;
            letter-spacing: 0.5px;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2rem, 5vw, 2.5rem);
            margin-bottom: 2rem;
            color: var(--primary-color);
            line-height: 1.2;
        }

        .paragraph {
            margin-bottom: 1.8rem;
            font-size: 1.2rem;
            color: var(--text-color);
            opacity: 0;
            transform: translateY(20px);
        }

        .highlight {
            background: var(--highlight-color);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            color: var(--primary-color);
            font-weight: 600;
            transition: background var(--transition-speed) ease;
        }

        .highlight:hover {
            background: rgba(128, 90, 213, 0.2);
        }

        .image-note {
            background: var(--background-color);
            padding: 1.5rem;
            border-radius: 8px;
            margin: 2rem 0;
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 0.95rem;
            opacity: 0;
            border-left: 4px solid var(--accent-color);
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .image-note i {
            color: var(--accent-color);
            font-size: 1.2rem;
            margin-top: 0.2rem;
        }

        .signature {
            margin-top: 4rem;
            font-family: 'Playfair Display', serif;
            font-style: italic;
            font-size: 1.3rem;
            text-align: right;
            opacity: 0;
            color: var(--primary-color);
        }

        .stamp {
            position: absolute;
            top: 40px;
            right: 40px;
            width: 100px;
            height: 100px;
            border: 2px solid var(--accent-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 0.8rem;
            color: var(--accent-color);
            transform: rotate(15deg);
            opacity: 0;
            text-align: center;
            padding: 1rem;
            backdrop-filter: blur(4px);
            background: rgba(255, 255, 255, 0.8);
        }

        .footnote {
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.7;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .scroll-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--card-background);
            padding: 1rem;
            border-radius: 50%;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transition: opacity var(--transition-speed) ease;
            cursor: pointer;
            color: var(--primary-color);
        }

        .scroll-indicator:hover {
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .letter-container {
                padding: 2rem;
                margin: 1rem;
            }
            
            .stamp {
                width: 80px;
                height: 80px;
                font-size: 0.7rem;
                top: 20px;
                right: 20px;
            }

            .scroll-indicator {
                bottom: 1rem;
                right: 1rem;
            }
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --primary-color: #a0aec0;
                --accent-color: #b794f4;
                --text-color: #e2e8f0;
                --background-color: #1a202c;
                --card-background: #2d3748;
                --highlight-color: rgba(183, 148, 244, 0.1);
            }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
        .sentiment-indicator {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            background: var(--card-background);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 0.9rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .reading-time {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-family: 'Source Sans Pro', sans-serif;
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.7;
        }

        .highlight-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--card-background);
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-width: 300px;
            display: none;
            font-family: 'Source Sans Pro', sans-serif;
        }

        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(to right, var(--accent-color), var(--primary-color));
            transform-origin: left;
            transform: scaleX(0);
        }
        .insight-card {
            background: var(--card-background);
            padding: 1rem;
            margin: 0.5rem 0;
            border-radius: 8px;
            border-left: 3px solid var(--accent-color);
        }

        .engagement-meter {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .meter-bar {
            height: 4px;
            flex-grow: 1;
            background: var(--highlight-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .meter-fill {
            height: 100%;
            background: var(--accent-color);
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="progress-bar"></div>
    <div class="reading-progress"></div>
    <div class="letter-container">
       
        <div class="date">December 27, 2024</div>
        <h1>Dear Bengaluru,</h1>
        
        <div class="paragraph">
          
            NamaskƒÅra Bengaluru I am writing this to show my admiration and respect towards your journey for being a constant hub of innovation in world. 
            From the serene mornings of Cubbon Park to the lively nights of Koramangala, your transformation from the "Garden City" to a center of research excellence is commendable. 
        
        </div>
        
        <div class="image-note">
            <i class="fas fa-landmark"></i>
            <div>
                The Indian Institute of Science (IISc) was established on 27th May 1909, is the core of the modern scientific heritage of our Nation. 
                With its large campus and world class research facilities, IISc has inspired the leading India's scientific landscape, producing pathbreaking research in various fields.
            </div>
        </div>
        
        <div class="paragraph">
            Your streets are filled with  astnoshing achievements for science , culture and technology that helped our nation
            The Raman Research Institute, the place wheere Sir C.V. Raman discovered the Raman Effect  is an institution guiding scientific research and become a hub for generations of researchers. 
            The National Aerospace Laboratories are at the forefront of research in aerospace sciences and the Indian Institute of Astrophysics in space sciences.
        </div>
        
        <div class="paragraph">
            The establishment of ISRO's satellite center is gateway of our new aspirations in journey to explore space , with missions like Chandrayaan 3 established India as Space powwerhouse.
             The U R Rao Satellite Centre has been important in developing over 100 satellites. 
             Furthermore, ISRO's work in satellite navigation and remote sensing continues to play a crucial role in national development.
        </div>
        
        <div class="image-note">
            <i class="fas fa-rocket"></i>
            <div>
                Ever since it was established, the U R Rao Satellite Centre has been instrumental in furthering India's space exploration, bringing many satellites into orbit as part of these very important missions.
            </div>
        </div>
        
        <div class="paragraph">
            Today, you continue to nurture innovation as you explore new fields like AI , Biotechnology .
             Your institutions  like the Centre for Development of Advanced Computing or the Institute for Stem Cell Biology and Regenerative Medicine are the leaders of research and forefront for solution of humanity's future needs.
             Your research & tech parks are place where technology and real-world applications come together.
        </div>
        
        <div class="paragraph">
            What makes you special isn't just your  institutions, but the lively spirit of curiosity. You have built everything from past achievements and still growing , the hunger to learn and innovate is what makes you special.
        </div>
        
        <div class="paragraph">
            Your green spaces remind us that moving forward doesn't mean hurting nature. The jacanda trees along your research walkways sybmolize that this is still the lake city with in which scinece living as a resident.Being the leaders in technology never losing the cultural identity was the biggest achievement all along !
        </div>
        
        <div class="signature">
            With deep admiration and hope for tomorrow!<br>
            A Grateful Observer<br>
            - Atul 
        </div>
        
        <div class="footnote">
            This letter is in response to a pre-interview task for part-time mediator at the Science Gallery Bengaluru's exhibition-season Sci560.
        </div>
    </div>

    <div class="scroll-indicator">
        <i class="fas fa-arrow-up"></i>
    </div>
    <div class="sentiment-indicator"></div>
    <div class="highlight-container">
        <h4>Reading Insights</h4>
        <div id="insights-content"></div>
    </div>

    <script>
           class EnhancedMLFeatures {
            constructor() {
                this.readingPatterns = [];
                this.scrollPatterns = [];
                this.dwellTimes = new Map();
                this.lastScrollPos = window.scrollY;
                this.lastScrollTime = Date.now();
                this.emotionalKeywords = {
                    wonder: ['inspiration', 'dreams', 'pride', 'hope'],
                    nostalgia: ['heritage', 'tradition', 'wisdom', 'roots'],
                    progress: ['innovation', 'technology', 'future', 'growth'],
                    identity: ['community', 'culture', 'legacy', 'spirit']
                };
                this.paragraphThemes = new Map();
            }

            analyzeSentiment(text) {
                let emotionalProfile = {
                    wonder: 0,
                    nostalgia: 0,
                    progress: 0,
                    identity: 0
                };

                const words = text.toLowerCase().split(' ');
                
                Object.entries(this.emotionalKeywords).forEach(([emotion, keywords]) => {
                    keywords.forEach(keyword => {
                        const count = words.filter(word => word.includes(keyword)).length;
                        emotionalProfile[emotion] += count;
                    });
                });

                const total = Object.values(emotionalProfile).reduce((a, b) => a + b, 0);
                if (total === 0) return null;

                Object.keys(emotionalProfile).forEach(key => {
                    emotionalProfile[key] = emotionalProfile[key] / total;
                });

                return emotionalProfile;
            }

            analyzeReadingEngagement() {
                const visibleParagraphs = Array.from(document.querySelectorAll('.paragraph'))
                    .filter(p => {
                        const rect = p.getBoundingClientRect();
                        return rect.top >= 0 && rect.bottom <= window.innerHeight;
                    });

                visibleParagraphs.forEach(p => {
                    const dwellTime = this.dwellTimes.get(p.id) || 0;
                    const sentiment = this.analyzeSentiment(p.textContent);
                    if (sentiment) {
                        this.paragraphThemes.set(p.id, {
                            sentiment,
                            engagement: dwellTime
                        });
                    }
                });

                return this.generateInsights();
            }

            generateInsights() {
                const insights = [];
                let totalEngagement = 0;
                let dominantThemes = new Map();

                this.paragraphThemes.forEach((data, id) => {
                    totalEngagement += data.engagement;
                    Object.entries(data.sentiment).forEach(([theme, value]) => {
                        dominantThemes.set(theme, (dominantThemes.get(theme) || 0) + value * data.engagement);
                    });
                });

               
                const sortedThemes = Array.from(dominantThemes.entries())
                    .sort(([, a], [, b]) => b - a);

                if (sortedThemes.length > 0) {
                    const primaryTheme = sortedThemes[0][0];
                    const secondaryTheme = sortedThemes[1] ? sortedThemes[1][0] : null;

                    insights.push({
                        title: 'Reading Pattern',
                        content: `Your reading shows strong engagement with ${primaryTheme}${secondaryTheme ? ` and ${secondaryTheme}` : ''} themes in the narrative.`
                    });

                    // Add theme-specific insights
                    const themeInsights = {
                        wonder: "You seem drawn to Bengaluru's inspiring scientific achievements",
                        nostalgia: "The city's historical evolution appears to resonate with you",
                        progress: "The technological advancement narrative captures your attention",
                        identity: "You connect with Bengaluru's unique cultural identity"
                    };

                    insights.push({
                        title: 'Key Interest',
                        content: themeInsights[primaryTheme]
                    });
                }

                return insights;
            }

            updateDwellTime(elementId) {
                if (!this.dwellTimes.has(elementId)) {
                    this.dwellTimes.set(elementId, 0);
                }
                this.dwellTimes.set(elementId, this.dwellTimes.get(elementId) + 1);
                
                // Update insights every second
                this.updateInsightsDisplay();
            }

            updateInsightsDisplay() {
                const insights = this.generateInsights();
                const container = document.getElementById('insights-content');
                
                if (insights.length > 0) {
                    container.innerHTML = insights.map(insight => `
                        <div class="insight-card">
                            <strong>${insight.title}</strong>
                            <p>${insight.content}</p>
                            <div class="engagement-meter">
                                <div class="meter-bar">
                                    <div class="meter-fill" style="width: ${Math.random() * 100}%"></div>
                                </div>
                            </div>
                        </div>
                    `).join('');
                }
            }
        }

        // Initialize enhanced ML features
        const mlFeatures = new EnhancedMLFeatures();

        // Update Reading Progress
        function updateReadingProgress() {
            const progress = document.querySelector('.reading-progress');
            const totalHeight = document.documentElement.scrollHeight - window.innerHeight;
            const scrolled = (window.scrollY / totalHeight);
            progress.style.transform = `scaleX(${scrolled})`;
        }

        // Initialize Observers
        const paragraphs = document.querySelectorAll('.paragraph');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                    
                    // Analyze sentiment of visible paragraphs
                    const sentiment = mlFeatures.analyzeSentiment(entry.target.textContent);
                    updateSentimentIndicator(sentiment);
                    
                    // Track dwell time
                    mlFeatures.updateDwellTime(entry.target.id);
                }
            });
        }, { threshold: 0.5 });

        // Add observers and event listeners
        paragraphs.forEach((p, i) => {
            p.id = `p${i}`;
            observer.observe(p);
        });

        window.addEventListener('scroll', () => {
            updateReadingProgress();
            const insights = mlFeatures.analyzeScrollPattern();
            if (insights) {
                updateHighlights(insights);
            }
        });

        // Update UI Elements
        function updateSentimentIndicator(sentiment) {
            const indicator = document.querySelector('.sentiment-indicator');
            indicator.style.opacity = '1';
            indicator.textContent = `Reading engagement: ${sentiment > 0 ? 'High' : 'Moderate'}`;
        }

        function updateHighlights(insights) {
            const container = document.querySelector('.highlight-container');
            if (insights.engagement === 'high') {
                container.style.display = 'block';
                const engagingContent = mlFeatures.getHighlightedContent();
                if (engagingContent.length > 0) {
                    container.querySelector('p').textContent = 
                        `You seem interested in sections about: ${engagingContent.join(', ')}`;
                }
            }
        }



        // Progress bar
        const progressBar = document.querySelector('.progress-bar');
        window.addEventListener('scroll', () => {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            progressBar.style.transform = `scaleX(${scrolled / 100})`;
        });

        // Scroll to top button
        const scrollIndicator = document.querySelector('.scroll-indicator');
        window.addEventListener('scroll', () => {
            scrollIndicator.style.opacity = window.scrollY > 100 ? '1' : '0';
        });
        
        scrollIndicator.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Intersection Observer for animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer1 = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, observerOptions);

        // Observe paragraphs and notes
        document.querySelectorAll('.paragraph, .image-note').forEach(el => {
            observer1.observe(el);
            el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        });

        // Animate stamp and signature
        anime({
            targets: '.stamp',
            opacity: [0, 1],
            scale: [0.5, 1],
            rotate: [0, 15],
            duration: 1000,
            easing: 'easeOutElastic(1, .5)',
            delay: 500
        });

        anime({
            targets: '.signature',
            opacity: [0, 1],
            translateY: [20, 0],
            duration: 800,
            easing: 'easeOutQuad',
            delay: 1000
        });

        setInterval(() => {
            mlFeatures.analyzeReadingEngagement();
        }, 1000);
    </script>
</body>
</html>